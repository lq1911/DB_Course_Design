# ğŸšª ç™»å½•/æ³¨å†Œé¡µ å‰ç«¯è¯´æ˜æ–‡æ¡£

## ğŸ“„ ä¸€. é¡µé¢æè¿°

### åŠŸèƒ½
æä¾›ç³»ç»Ÿç»Ÿä¸€çš„ç™»å½•å’Œå¤šè§’è‰²æ³¨å†Œå…¥å£ã€‚

### è·¯å¾„
`/login` (ç”±è·¯ç”±é…ç½®å†³å®š)

### æ–‡ä»¶
`src/views/login/LoginView.vue`

---

## ğŸ¯ äºŒ. æ ¸å¿ƒåŠŸèƒ½ç‚¹

- ğŸ”„ **è¡¨å•åˆ‡æ¢**: æ”¯æŒåœ¨â€œç™»å½•â€å’Œâ€œæ³¨å†Œâ€ä¸¤ä¸ªè¡¨å•ä¹‹é—´åˆ‡æ¢ã€‚
- ğŸ‘¥ **è§’è‰²ç³»ç»Ÿ**: æ”¯æŒâ€œç®¡ç†å‘˜â€ã€â€œå•†å®¶â€ã€â€œéª‘æ‰‹â€ã€â€œæ¶ˆè´¹è€…â€å››ç§è§’è‰²çš„ç™»å½•å’Œæ³¨å†Œã€‚
- ğŸ“ **åŠ¨æ€è¡¨å•**: æ³¨å†Œè¡¨å•ä¼šæ ¹æ®æ‰€é€‰è§’è‰²åŠ¨æ€å¢å‡ä¸“å±ä¿¡æ¯å­—æ®µã€‚
- â³ **å¼‚æ­¥å¤„ç†**: ç™»å½•å’Œæ³¨å†ŒæœŸé—´ï¼Œæäº¤æŒ‰é’®ä¼šæ˜¾ç¤ºåŠ è½½çŠ¶æ€å¹¶è¢«ç¦ç”¨ã€‚
- ğŸ’¬ **å“åº”å¤„ç†**: æ“ä½œæˆåŠŸæˆ–å¤±è´¥æ—¶ï¼Œä¼šé€šè¿‡ **alert** å¼¹å‡ºåç«¯è¿”å›çš„ä¿¡æ¯ã€‚
- ğŸ—ï¸ **Token å­˜å‚¨**: ç™»å½•æˆåŠŸåï¼Œä¼šå°†åç«¯è¿”å›çš„ **token** å­˜å…¥ `localStorage`ã€‚
- ğŸ“œ **åè®®å¼¹çª—**: æ³¨å†Œæ—¶ï¼Œç”¨æˆ·åè®®å’Œéšç§æ”¿ç­–é€šè¿‡å¼¹çª—å±•ç¤ºã€‚

---

## ğŸ”Œ ä¸‰. è°ƒç”¨æ¥å£

æ‰€æœ‰æ¥å£é€šè¿‡ `src/services/api.ts` æ¨¡å—å‘èµ·ï¼Œè¯¥æ¨¡å—é…ç½®çš„åŸºç¡€è·¯å¾„ä¸º `/api`ã€‚

### ğŸŒ æ¥å£è°ƒç”¨è¯´æ˜

æ‰€æœ‰æ¥å£è¯·æ±‚å‡é€šè¿‡ `src/services/api.ts` æ–‡ä»¶ä¸­å°è£…çš„å‡½æ•°å‘èµ·ã€‚

- **è¯·æ±‚åŸºç¡€è·¯å¾„** (baseURL): `http://localhost:3000/api`
- **å…¨å±€è¯·æ±‚å¤´** (Headers): `Content-Type: application/json`

---

### 1. ğŸ« ç”¨æˆ·ç™»å½•æ¥å£

#### ğŸ” å‰ç«¯è°ƒç”¨:
`api.login(data)`

#### ğŸŒ è¯·æ±‚è·¯å¾„:
`POST /login`

#### ğŸ“ æ¥å£è¯´æ˜:
æ¥æ”¶ç”¨æˆ·å‡­è¯ï¼ŒéªŒè¯æˆåŠŸåè¿”å›èº«ä»½ä»¤ç‰Œ (Token) å’Œç”¨æˆ·ä¿¡æ¯ã€‚

#### ğŸ“¤ å‰ç«¯å‘é€çš„è¯·æ±‚ä½“ (Request Body)

å‰ç«¯ä¼šå‘é€ä¸€ä¸ªç¬¦åˆ `UserData` æ¥å£çš„å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå      | ç±»å‹   | æ¥æº (å‰ç«¯å˜é‡)       | ç¤ºä¾‹å€¼           |
| ----------- | ------ | --------------------- | ---------------- |
| account     | string | `loginForm.account`    | `"user@example.com"` |
| password    | string | `loginForm.password`   | `"123456"`       |
| role        | string | `selectedRole.value`   | `"consumer"`     |

#### ğŸ“¥ å‰ç«¯æœŸæœ›çš„è¿”å›ä½“ (Response Body)

- **ç™»å½•æˆåŠŸ (HTTP çŠ¶æ€ç  200)**:
  
  å‰ç«¯æœŸæœ›æ¥æ”¶ä¸€ä¸ª JSON å¯¹è±¡ï¼Œè‡³å°‘åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

  | å­—æ®µå     | ç±»å‹   | è¯´æ˜                                 |
  | ---------- | ------ | ------------------------------------ |
  | token      | string | å¿…éœ€ã€‚ç”¨äºåç»­è¯·æ±‚èº«ä»½éªŒè¯çš„ JWTã€‚   |
  | user       | object | å¿…éœ€ã€‚åŒ…å«ç™»å½•ç”¨æˆ·ä¿¡æ¯çš„å¯¹è±¡ã€‚       |
  | message    | string | å¯é€‰ã€‚æˆåŠŸçš„æç¤ºä¿¡æ¯ï¼Œå¦‚â€œç™»å½•æˆåŠŸï¼â€ |

- **ç™»å½•å¤±è´¥ (HTTP çŠ¶æ€ç  4xx æˆ– 5xx)**:

  å‰ç«¯æœŸæœ›æ¥æ”¶ä¸€ä¸ª JSON å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼š

  | å­—æ®µå     | ç±»å‹   | è¯´æ˜                               |
  | ---------- | ------ | ---------------------------------- |
  | error      | string | å¿…éœ€ã€‚æè¿°å¤±è´¥åŸå› çš„å­—ç¬¦ä¸²ï¼Œå¦‚â€œè´¦å·æˆ–å¯†ç é”™è¯¯â€ã€‚ |

---

### 2. ğŸ“ ç”¨æˆ·æ³¨å†Œæ¥å£

#### ğŸ”‘ å‰ç«¯è°ƒç”¨:
`api.register(data)`

#### ğŸŒ è¯·æ±‚è·¯å¾„:
`POST /register`

#### ğŸ“ æ¥å£è¯´æ˜:
æ¥æ”¶å®Œæ•´çš„ç”¨æˆ·æ³¨å†Œä¿¡æ¯ï¼ˆåŒ…å«åŸºç¡€ä¿¡æ¯å’Œè§’è‰²ç‰¹å®šä¿¡æ¯ï¼‰ï¼Œåˆ›å»ºæ–°ç”¨æˆ·ã€‚

#### ğŸ“¤ å‰ç«¯å‘é€çš„è¯·æ±‚ä½“ (Request Body)

å‰ç«¯ä¼šå‘é€ä¸€ä¸ªç¬¦åˆ `RegistrationData` æ¥å£çš„å¯¹è±¡ï¼Œå…¶ç»“æ„æ ¹æ®ç”¨æˆ·é€‰æ‹©çš„è§’è‰²åŠ¨æ€å˜åŒ–ã€‚

##### é€šç”¨å­—æ®µ (æ‰€æœ‰è§’è‰²éƒ½ä¼šå‘é€):

| å­—æ®µå          | ç±»å‹   | æ¥æº (å‰ç«¯å˜é‡)         | ç¤ºä¾‹å€¼              |
| --------------- | ------ | ----------------------- | ------------------- |
| nickname        | string | `registerForm.nickname`  | `"æ–°ç”¨æˆ·123"`        |
| password        | string | `registerForm.password`  | `"mysecretpwd"`      |
| confirmPassword | string | `registerForm.confirmPassword` | `"mysecretpwd"`  |
| phone           | string | `registerForm.phone`     | `"13800138000"`      |
| email           | string | `registerForm.email`     | `"new@example.com"`  |
| gender          | string | `registerForm.gender`    | `"female"`           |
| birthday        | string | `registerForm.birthday`  | `"2000-01-01"`       |
| verificationCode| string | `registerForm.verificationCode` | `"123456"`    |
| role            | string | `selectedRole.value`     | `"merchant"`         |
| avatarUrl       | string | `registerForm.avatarUrl` | `""`                 |
| isPublic        | number | `registerForm.isPublic`  | `0`                  |

##### è§’è‰²ç‰¹å®šå­—æ®µ (æ ¹æ® `role` å­—æ®µé€‰æ‹©æ€§åŒ…å«)

- å½“ `role` ä¸º `'rider'` æ—¶ï¼Œè¯·æ±‚ä½“ä¸­ä¼šé¢å¤–åŒ…å« `riderInfo` å¯¹è±¡ï¼š

  | å­—æ®µå              | ç±»å‹   | æ˜¯å¦å¿…å¡« | è¯´æ˜     |
  | ------------------- | ------ | -------- | -------- |
  | riderInfo.vehicleType | string | æ˜¯       | é…é€è½¦å‹ |

- å½“ `role` ä¸º `'admin'` æ—¶ï¼Œè¯·æ±‚ä½“ä¸­ä¼šé¢å¤–åŒ…å« `adminInfo` å¯¹è±¡ï¼š

  | å­—æ®µå               | ç±»å‹   | æ˜¯å¦å¿…å¡« | è¯´æ˜           |
  | -------------------- | ------ | -------- | -------------- |
  | adminInfo.managementObject | string | æ˜¯       | ç®¡ç†å¯¹è±¡       |
  | adminInfo.handledItems   | string | æ˜¯       | å¤„ç†äº‹é¡¹è¯´æ˜   |

- å½“ `role` ä¸º `'merchant'` æ—¶ï¼Œè¯·æ±‚ä½“ä¸­ä¼šé¢å¤–åŒ…å« `storeInfo` å¯¹è±¡ï¼š

  | å­—æ®µå                | ç±»å‹         | æ˜¯å¦å¿…å¡« | è¯´æ˜           |
  | --------------------- | ------------ | -------- | -------------- |
  | storeInfo.name         | string       | æ˜¯       | åº—é“ºåç§°       |
  | storeInfo.address      | string       | æ˜¯       | åº—é“ºåœ°å€       |
  | storeInfo.businessHours | string       | æ˜¯       | è¥ä¸šæ—¶é—´       |
  | storeInfo.establishmentDate | string   | æ˜¯       | åº—é“ºå»ºç«‹æ—¶é—´   |
  | storeInfo.businessLicense | File æˆ– null | æ˜¯       | è¥ä¸šæ‰§ç…§æ–‡ä»¶   |
  | storeInfo.category     | string       | æ˜¯       | ç»è¥ç±»åˆ«       |

---

## è¿”å›å‚æ•°è¯´æ˜

### â‡’ æ³¨å†ŒæˆåŠŸ

| å­—æ®µå    | ç±»å‹   | è¯´æ˜                           |
| --------- | ------ | ------------------------------ |
| code      | int    | çŠ¶æ€ç ï¼Œ201 è¡¨ç¤ºæˆåŠŸã€‚          |
| message   | string | è¿”å›çš„æç¤ºä¿¡æ¯ï¼Œå¦‚â€œæ³¨å†ŒæˆåŠŸï¼â€ |

### â‡’ æ³¨å†Œå¤±è´¥

| å­—æ®µå    | ç±»å‹   | è¯´æ˜                                         |
| --------- | ------ | -------------------------------------------- |
| code      | int    | çŠ¶æ€ç ï¼Œå¦‚ 400ã€409 ç­‰ã€‚                     |
| error     | string | æè¿°å¤±è´¥åŸå› çš„å­—ç¬¦ä¸²ï¼Œå¦‚â€œè¯¥æ‰‹æœºå·å·²è¢«æ³¨å†Œâ€ã€‚ |

