# ç™»å½•/æ³¨å†Œé¡µå‰ç«¯è¯´æ˜æ–‡æ¡£

## ğŸ“‹ é¡µé¢æè¿°

æœ¬é¡µé¢æ˜¯ç³»ç»Ÿçš„ç»Ÿä¸€å…¥å£ï¼Œé‡‡ç”¨ Vue 3 (Composition API) å’Œ Tailwind CSS æ„å»ºã€‚å®ƒä¸ºä¸åŒèº«ä»½çš„ç”¨æˆ·ï¼ˆæ¶ˆè´¹è€…ã€å•†å®¶ã€éª‘æ‰‹ã€ç®¡ç†å‘˜ï¼‰æä¾›äº†åŠ¨æ€çš„ã€å“åº”å¼çš„æ³¨å†Œå’Œç™»å½•åŠŸèƒ½ã€‚

- **ç™»å½•é¡µ**: ç”¨æˆ·é€šè¿‡é€‰æ‹©èº«ä»½ã€è¾“å…¥è´¦å·ï¼ˆæ‰‹æœºå·/é‚®ç®±ï¼‰å’Œå¯†ç è¿›è¡ŒéªŒè¯ã€‚æ”¯æŒâ€œè®°ä½å¯†ç â€å’Œç¬¬ä¸‰æ–¹è´¦å·å¿«é€Ÿç™»å½•ã€‚
- **æ³¨å†Œé¡µ**: ç”¨æˆ·é¦–å…ˆé€‰æ‹©èº«ä»½ï¼Œé¡µé¢ä¼šåŠ¨æ€æ¸²æŸ“å‡ºå¯¹åº”èº«ä»½æ‰€éœ€çš„å…¨éƒ¨æ³¨å†Œå­—æ®µã€‚è¡¨å•åŒ…å«å‰ç«¯è¾“å…¥éªŒè¯ï¼Œå¹¶ä¸ºå•†å®¶ã€éª‘æ‰‹ã€ç®¡ç†å‘˜ç­‰è§’è‰²æä¾›äº†ä¸“å±çš„ä¿¡æ¯å¡«å†™åŒºåŸŸã€‚

ğŸ“ **é¡µé¢è·¯å¾„**  
- ç™»å½•/æ³¨å†Œç»Ÿä¸€è·¯å¾„: `/` æˆ– `/auth` (å…·ä½“ç”±è·¯ç”±é…ç½®å†³å®š)  
- é¡µé¢ç»„ä»¶æ–‡ä»¶: `LoginPage.vue` (ç¤ºä¾‹å‘½å)

---

## ğŸ› ï¸ é¡µé¢åŠŸèƒ½ç‚¹è¯¦è§£

### ğŸ”„ Tabåˆ‡æ¢
- é€šè¿‡ `activeTab` å˜é‡ (`'login'` æˆ– `'register'`) æ§åˆ¶æ˜¾ç¤ºç™»å½•æˆ–æ³¨å†Œè¡¨å•ã€‚
- UI ä¸Šè¡¨ç°ä¸ºâ€œç™»å½•â€å’Œâ€œæ³¨å†Œâ€ä¸¤ä¸ªå¯ç‚¹å‡»çš„æŒ‰é’®ï¼Œæœ‰æ˜ç¡®çš„æ¿€æ´»çŠ¶æ€ã€‚

### ğŸ‘¤ èº«ä»½é€‰æ‹©
- é€šè¿‡ `selectedRole` å˜é‡æ§åˆ¶ç”¨æˆ·é€‰æ‹©çš„èº«ä»½ (`consumer`, `merchant`, `rider`, `admin`)ã€‚
- UI ä¸Šè¡¨ç°ä¸ºå››ä¸ªå¸¦å›¾æ ‡çš„å•é€‰æ¡†ï¼Œé€‰ä¸­æ—¶æœ‰é«˜äº®æ•ˆæœã€‚
- æ³¨å†Œè¡¨å•çš„å†…å®¹ä¼šæ ¹æ® `selectedRole` çš„å€¼åŠ¨æ€æ˜¾ç¤ºæˆ–éšè—ç‰¹å®šå­—æ®µã€‚

### ğŸ”‘ ç™»å½•åŠŸèƒ½ (`activeTab === 'login'`)
- **è¡¨å•æ•°æ®**ï¼šç»‘å®šåˆ° `loginForm` å¯¹è±¡ï¼ŒåŒ…å« `account` å’Œ `password` å­—æ®µã€‚
- **å¯†ç å¯è§æ€§**ï¼šé€šè¿‡ `showPassword` å˜é‡å’Œç‚¹å‡»äº‹ä»¶åˆ‡æ¢å¯†ç è¾“å…¥æ¡†çš„ `type` å±æ€§ã€‚
- **è®°ä½å¯†ç **ï¼šé€šè¿‡ `rememberPassword` å¤é€‰æ¡†è®°å½•ç”¨æˆ·åå¥½ã€‚
- **æäº¤é€»è¾‘**ï¼šè°ƒç”¨ `handleLogin` æ–¹æ³•ï¼Œåœ¨è¯·æ±‚æœŸé—´ `isLoading` çŠ¶æ€ä¸º `true`ï¼ŒæŒ‰é’®æ˜¾ç¤ºåŠ è½½ä¸­å¹¶è¢«ç¦ç”¨ã€‚

### ğŸ“ æ³¨å†ŒåŠŸèƒ½ (`activeTab === 'register'`)
- **é€šç”¨ä¿¡æ¯è¡¨å•**ï¼šç»‘å®šåˆ° `registerForm` å¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰ç”¨æˆ·å…±æœ‰çš„å­—æ®µï¼Œå¦‚ `nickname`, `phone`, `email`, `password` ç­‰ã€‚
- **è§’è‰²ç‰¹å®šä¿¡æ¯**ï¼š
  - **éª‘æ‰‹**ï¼šé¢å¤–è¡¨å•ç»‘å®šåˆ° `riderInfo` å¯¹è±¡ (`vehicleType`, `monthlySalary` ç­‰)ã€‚
  - **ç®¡ç†å‘˜**ï¼šé¢å¤–è¡¨å•ç»‘å®šåˆ° `adminInfo` å¯¹è±¡ (`managementObject`, `handledItems`)ã€‚
  - **å•†å®¶**ï¼šé¢å¤–è¡¨å•ç»‘å®šåˆ° `merchantInfo` å’Œ `storeInfo` å¯¹è±¡ï¼ŒåŒ…å«åº—é“ºåç§°ã€åœ°å€ã€è¥ä¸šæ—¶é—´ã€è¥ä¸šæ‰§ç…§ä¸Šä¼ ç­‰å¤æ‚å­—æ®µã€‚
- **éªŒè¯ç **ï¼š`sendVerificationCode` æ–¹æ³•è´Ÿè´£å‘é€éªŒè¯ç ï¼Œå¹¶ä½¿ç”¨ `codeCountdown` å®ç° 60 ç§’å€’è®¡æ—¶ã€‚
- **ç”¨æˆ·åè®®**ï¼šå¿…é¡»å‹¾é€‰ `agreeTerms` å¤é€‰æ¡†ï¼Œå¦åˆ™æ³¨å†ŒæŒ‰é’®ç¦ç”¨ã€‚
- **æäº¤é€»è¾‘**ï¼šè°ƒç”¨ `handleRegister` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè°ƒç”¨ `validateRegisterForm` è¿›è¡Œå…¨é¢çš„å‰ç«¯æ ¡éªŒï¼Œé€šè¿‡åæ‰å‘é€è¯·æ±‚ã€‚

### ğŸ—£ï¸ ç¬¬ä¸‰æ–¹ç™»å½•
- é¡µé¢åº•éƒ¨æä¾›äº† Googleã€Facebookã€WeChat çš„ç™»å½•æŒ‰é’®ï¼Œé¢„ç•™äº†ç¬¬ä¸‰æ–¹ç™»å½•æ¥å£çš„è°ƒç”¨ä½ç½®ã€‚

---

## ğŸ”Œ è°ƒç”¨æ¥å£

### 1. ç”¨æˆ·ç™»å½•æ¥å£

- **æ¥å£è¯´æ˜**: éªŒè¯ç”¨æˆ·èº«ä»½å¹¶è¿”å› Tokenã€‚åœ¨å‰ç«¯ `handleLogin` å‡½æ•°ä¸­è°ƒç”¨ã€‚
- **è¯·æ±‚è·¯å¾„**: `/api/auth/login`
- **è¯·æ±‚æ–¹æ³•**: `POST`

#### è¯·æ±‚å‚æ•°è¯´æ˜ (`loginForm` & `selectedRole`)

| å­—æ®µå     | ç±»å‹   | æ˜¯å¦å¿…å¡« | è¯´æ˜                               |
| ---------- | ------ | -------- | ---------------------------------- |
| `identity` | string | æ˜¯       | ç”¨æˆ·é€‰æ‹©çš„èº«ä»½ã€‚å€¼ä¸ºï¼š`consumer`, `merchant`, `rider`, `admin`ã€‚å¯¹åº” `selectedRole`ã€‚ |
| `account`  | string | æ˜¯       | ç”¨æˆ·è¾“å…¥çš„æ‰‹æœºå·æˆ–é‚®ç®±ã€‚å¯¹åº” `loginForm.account`ã€‚ |
| `password` | string | æ˜¯       | ç”¨æˆ·ç™»å½•å¯†ç ã€‚å¯¹åº” `loginForm.password`ã€‚ |

#### è¿”å›å‚æ•°è¯´æ˜

| å­—æ®µå     | ç±»å‹   | è¯´æ˜                               |
| ---------- | ------ | ---------------------------------- |
| `code`     | int    | çŠ¶æ€ç ï¼Œ200 è¡¨ç¤ºæˆåŠŸã€‚              |
| `message`  | string | è¿”å›çš„æç¤ºä¿¡æ¯ã€‚                    |
| `data.token` | string | ç™»å½•æˆåŠŸåè¿”å›çš„è®¤è¯ Tokenã€‚       |
| `data.user`  | object | ç™»å½•æˆåŠŸçš„ç”¨æˆ·ä¿¡æ¯ï¼Œå¯ç”¨äºç›´æ¥æ¸²æŸ“é¦–é¡µï¼Œå‡å°‘ä¸€æ¬¡è¯·æ±‚ã€‚ |

---

### 2. å‘é€æ³¨å†ŒéªŒè¯ç æ¥å£

- **æ¥å£è¯´æ˜**: å‘ç”¨æˆ·æ‰‹æœºå·å‘é€çŸ­ä¿¡éªŒè¯ç ã€‚åœ¨å‰ç«¯ `sendVerificationCode` å‡½æ•°ä¸­è°ƒç”¨ã€‚
- **è¯·æ±‚è·¯å¾„**: `/api/auth/send-code`
- **è¯·æ±‚æ–¹æ³•**: `POST`

#### è¯·æ±‚å‚æ•°è¯´æ˜

| å­—æ®µå  | ç±»å‹   | æ˜¯å¦å¿…å¡« | è¯´æ˜                    |
| ------- | ------ | -------- | ----------------------- |
| `phone` | string | æ˜¯       | ç”¨æˆ·è¾“å…¥çš„ 11 ä½æ‰‹æœºå·ç ã€‚å¯¹åº” `registerForm.phone`ã€‚ |

---

### 3. ç”¨æˆ·æ³¨å†Œæ¥å£

- **æ¥å£è¯´æ˜**: æ¥æ”¶åŒ…å«æ‰€æœ‰ä¿¡æ¯çš„è¡¨å•ï¼Œåˆ›å»ºæ–°ç”¨æˆ·åŠå…³è”ä¿¡æ¯ã€‚åœ¨å‰ç«¯ `handleRegister` å‡½æ•°ä¸­è°ƒç”¨ã€‚
- **è¯·æ±‚è·¯å¾„**: `/api/auth/register`
- **è¯·æ±‚æ–¹æ³•**: `POST`

#### è¯·æ±‚å‚æ•°è¯´æ˜ (`ä¸€ä¸ªå¤æ‚çš„ JSON å¯¹è±¡`)

è¯·æ±‚ä½“æ ¹æ® `identity` å­—æ®µçš„å€¼ï¼Œç»“æ„ä¼šæœ‰æ‰€ä¸åŒã€‚

##### é€šç”¨ç»“æ„ï¼š

```json
{
  "identity": "consumer", // æˆ–è€… "merchant", "rider", "admin"
  "user": {
    "username": "ç”¨æˆ·æ˜µç§°",      // å¯¹åº” registerForm.nickname (varchar(15))
    "password": "ç”¨æˆ·å¯†ç ",      // å¯¹åº” registerForm.password (varchar(10))
    "phoneNumber": "13800138000", // å¯¹åº” registerForm.phone (number(11,0))
    "email": "user@example.com",  // å¯¹åº” registerForm.email (varchar(30))
    "gender": "ç”·",             // å¯¹åº” registerForm.gender (varchar(2))
    "birthday": "2000-01-01",     // å¯¹åº” registerForm.birthday (date)
    "verificationCode": "123456" // å¯¹åº” registerForm.verificationCode
  },
  // ä»¥ä¸‹ä¸ºç‰¹å®šè§’è‰²ä¿¡æ¯ï¼Œæ ¹æ® identity å­—æ®µä¸‰é€‰ä¸€ï¼Œæˆ–å…¨æ— (æ¶ˆè´¹è€…)
  "riderInfo": { ... },
  "adminInfo": { ... },
  "storeInfo": { ... }
}

```

### è§’è‰²ç‰¹å®šä¿¡æ¯è¯¦æƒ…

#### å½“ `identity = rider` æ—¶ï¼ŒåŒ…å« `riderInfo` å¯¹è±¡ï¼š

| å­—æ®µå             | ç±»å‹   | è¯´æ˜                                   |
| ------------------ | ------ | -------------------------------------- |
| `vehicleType`      | string | é…é€è½¦å‹ã€‚å¯¹åº” `riderInfo.vehicleType` (varchar(20))ã€‚ |
| `avgDeliveryTime`  | string | å¹³å‡é…é€æ—¶é—´ã€‚å¯¹åº” `riderInfo.avgDeliveryTime`ã€‚ |
| `monthlySalary`    | number | é¢„æœŸæœˆè–ªã€‚å¯¹åº” `riderInfo.monthlySalary` (integer)ã€‚ |

#### å½“ `identity = admin` æ—¶ï¼ŒåŒ…å« `adminInfo` å¯¹è±¡ï¼š

| å­—æ®µå             | ç±»å‹   | è¯´æ˜                                   |
| ------------------ | ------ | -------------------------------------- |
| `managedEntities`  | string | ç®¡ç†å¯¹è±¡ã€‚å¯¹åº” `adminInfo.managementObject` (varchar(50))ã€‚ |
| `issueDescription` | string | å¤„ç†äº‹é¡¹è¯´æ˜ã€‚å¯¹åº” `adminInfo.handledItems`ã€‚ |

#### å½“ `identity = merchant` æ—¶ï¼ŒåŒ…å« `storeInfo` å¯¹è±¡ï¼š

| å­—æ®µå             | ç±»å‹   | è¯´æ˜                                   |
| ------------------ | ------ | -------------------------------------- |
| `storeName`        | string | åº—é“ºåç§°ã€‚å¯¹åº” `storeInfo.name` (varchar(50))ã€‚ |
| `storeAddress`     | string | åº—é“ºåœ°å€ã€‚å¯¹åº” `storeInfo.address` (varchar(100))ã€‚ |
| `businessHours`    | object | è¥ä¸šæ—¶é—´ã€‚å¯¹åº” `storeInfo.businessHours` (json æˆ– text å­˜å‚¨)ã€‚ |
| `storeCreationTime`| date   | åº—é“ºå»ºç«‹æ—¶é—´ã€‚å¯¹åº” `storeInfo.establishmentDate` (date)ã€‚ |
| `storeFeatures`    | string | ç»è¥ç±»åˆ«ã€‚å¯¹åº” `storeInfo.category` (varchar(500))ã€‚ |
| `contactPhone`     | string | åº—é“ºè”ç³»ç”µè¯ã€‚å¯¹åº” `storeInfo.contactPhone`ã€‚ |
| `businessLicense`  | file   | æ­¤å­—æ®µåº”é€šè¿‡ç‹¬ç«‹çš„ä¸Šä¼ æ¥å£å¤„ç†ï¼Œæ³¨å†Œæ¥å£åªä¼ é€’ URLã€‚ |

---

### è¿”å›å‚æ•°è¯´æ˜

| å­—æ®µå   | ç±»å‹   | è¯´æ˜                                    |
| -------- | ------ | --------------------------------------- |
| `code`   | int    | çŠ¶æ€ç ï¼Œ200 è¡¨ç¤ºæˆåŠŸã€‚                   |
| `message`| string | è¿”å›çš„æç¤ºä¿¡æ¯ï¼Œå¦‚ â€œæ³¨å†ŒæˆåŠŸâ€ã€‚         |

---

### 4. æ–‡ä»¶ä¸Šä¼ æ¥å£ (å»ºè®®)

**æ¥å£è¯´æ˜**: ç”¨äºä¸Šä¼ å•†å®¶è¥ä¸šæ‰§ç…§ç­‰æ–‡ä»¶ã€‚

- **è¯·æ±‚è·¯å¾„**: `/api/upload/license`
- **è¯·æ±‚æ–¹æ³•**: `POST` (ä½¿ç”¨ `multipart/form-data`)

#### è¿”å›å‚æ•°

| å­—æ®µå | ç±»å‹   | è¯´æ˜                                           |
| ------ | ------ | ---------------------------------------------- |
| `url`  | string | è¿”å›ä¸Šä¼ æˆåŠŸåçš„æ–‡ä»¶ URLï¼Œè¯¥ URL å°†è¢«ç”¨äºæ³¨å†Œæ¥å£çš„ `businessLicense` å­—æ®µã€‚ |

---

### UIè®¾è®¡ç¨¿

**UIå®ç°**:[åŸå‹å›¾è·³è½¬](https://readdy.link/share/65c24cf2b09e237ddc952325997ca7f8)ã€‚
